<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>The Prophecies of Isaiah - Interactive Map</title>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/react/18.2.0/umd/react.production.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/react-dom/18.2.0/umd/react-dom.production.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/babel-standalone/7.23.5/babel.min.js"></script>
  <script src="https://cdn.tailwindcss.com"></script>
  <link href="https://fonts.googleapis.com/css2?family=Crimson+Pro:ital,wght@0,400;0,600;0,700;1,400&family=Cinzel:wght@400;600;700&display=swap" rel="stylesheet">
  <style>
    * { font-family: 'Crimson Pro', Georgia, serif; }
    .cinzel { font-family: 'Cinzel', serif; }
    body {
      background: linear-gradient(135deg, #2c1810 0%, #1a0f0a 50%, #0d0705 100%);
      min-height: 100vh;
    }
    .parchment-bg {
      background: linear-gradient(135deg, #f4e4bc 0%, #e8d5b7 50%, #dcc9a8 100%);
      box-shadow: inset 0 0 100px rgba(139, 115, 85, 0.3), 0 10px 40px rgba(0,0,0,0.5);
    }
    .scroll-border {
      border: 3px solid #8B7355;
      border-image: linear-gradient(135deg, #D4AF37, #8B7355, #D4AF37) 1;
    }
    .scripture-box {
      background: linear-gradient(135deg, rgba(139, 115, 85, 0.15) 0%, rgba(212, 175, 55, 0.1) 100%);
      border-left: 3px solid #D4AF37;
    }
    .timeline-dot { transition: all 0.3s ease; }
    .timeline-dot:hover { transform: scale(1.3); }
    .timeline-dot.active { box-shadow: 0 0 10px #D4AF37, 0 0 20px rgba(212, 175, 55, 0.5); }
    .nav-btn {
      background: linear-gradient(135deg, #3d2e1e 0%, #2c1810 100%);
      border: 2px solid #8B7355;
      transition: all 0.3s ease;
    }
    .nav-btn:hover:not(:disabled) {
      background: linear-gradient(135deg, #5c4a32 0%, #3d2e1e 100%);
      border-color: #D4AF37;
      box-shadow: 0 0 15px rgba(212, 175, 55, 0.3);
    }
    .nav-btn:disabled { opacity: 0.4; cursor: not-allowed; }
    .fade-in { animation: fadeIn 0.5s ease-out; }
    @keyframes fadeIn {
      from { opacity: 0; transform: translateY(10px); }
      to { opacity: 1; transform: translateY(0); }
    }
    .map-container {
      background: url("data:image/svg+xml,%3Csvg viewBox='0 0 100 100' xmlns='http://www.w3.org/2000/svg'%3E%3Cfilter id='noise'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='0.8' numOctaves='4' stitchTiles='stitch'/%3E%3C/filter%3E%3Crect width='100%25' height='100%25' filter='url(%23noise)' opacity='0.05'/%3E%3C/svg%3E"),
        linear-gradient(135deg, #f4e4bc 0%, #e8d5b7 50%, #dcc9a8 100%);
    }
    .territory-path {
      transition: fill 0.8s ease, stroke 0.5s ease;
    }
  </style>
</head>
<body>
  <div id="root"></div>
  
  <script type="text/babel">
    const { useState, useEffect } = React;

    // Chapter-to-Event mapping for Isaiah 1-66
    // eventIndex: which map event to show (null = default/event 0)
    // title: short chapter title
    // note: contextual paragraph explaining the chapter
    const chapterMapping = [
      {
        chapter: 1,
        eventIndex: 0,
        title: "Judah's Rebellion",
        note: "Isaiah's opening chapter introduces his prophetic ministry during the reigns of Uzziah, Jotham, Ahaz, and Hezekiah. Judah stands unconquered but spiritually corrupt—God compares Jerusalem to Sodom. The LORD calls His people to repentance: 'Though your sins are like scarlet, they shall be as white as snow.' Judgment looms, but restoration remains possible."
      },
      {
        chapter: 2,
        eventIndex: 18,
        title: "The Mountain of the LORD",
        note: "Isaiah glimpses the ultimate future: all nations streaming to Zion to learn God's ways. 'They shall beat their swords into plowshares.' Yet before this glory comes judgment—the Day of the LORD will humble human pride. This chapter sets the pattern of Isaiah: judgment now, glory later."
      },
      {
        chapter: 3,
        eventIndex: 0,
        title: "Judgment on Judah's Leaders",
        note: "God pronounces judgment on Judah's corrupt leadership. The elders and princes have plundered the poor; the women of Jerusalem flaunt their wealth. Society is collapsing—'children shall be their princes, and infants shall rule over them.' The map shows Judah before foreign invasion, but internal rot has already begun."
      },
      {
        chapter: 4,
        eventIndex: 18,
        title: "The Branch of the LORD",
        note: "After judgment comes restoration. The 'Branch of the LORD' (a Messianic title) will be beautiful and glorious. The survivors in Jerusalem will be called holy. God will create over Zion a cloud by day and fire by night—echoing the Exodus. This brief chapter bridges judgment and hope."
      },
      {
        chapter: 5,
        eventIndex: 0,
        title: "The Song of the Vineyard",
        note: "God's vineyard (Judah) has produced wild grapes despite His careful tending. Six 'woes' follow against those who accumulate land, drink from morning to night, call evil good, and acquit the guilty. At the chapter's end, God whistles for a distant nation—Assyria is coming, though not yet named."
      },
      {
        chapter: 6,
        eventIndex: 0,
        title: "Isaiah's Commission",
        note: "In the year King Uzziah died (~740 BC), Isaiah sees the LORD enthroned in the temple. Seraphim cry 'Holy, holy, holy!' Isaiah's lips are cleansed with a burning coal, and he volunteers: 'Here am I! Send me.' His mission: preach until the cities lie waste. The map shows the nations before judgment begins."
      },
      {
        chapter: 7,
        eventIndex: 1,
        title: "The Sign of Immanuel",
        note: "The Syro-Ephraimite crisis: Aram (Syria) and Israel threaten Judah. King Ahaz trembles, but Isaiah offers a sign—the virgin shall conceive and bear a son called Immanuel ('God with us'). Before the child knows right from wrong, both threatening kings will be gone. But Ahaz refuses to trust God, setting Judah on a dangerous path."
      },
      {
        chapter: 8,
        eventIndex: 2,
        title: "Assyria the Instrument",
        note: "Isaiah's son Maher-Shalal-Hash-Baz ('swift is the spoil') becomes a sign: before he can speak, Assyria will plunder Damascus and Samaria. The flood of Assyrian armies will reach even to Judah's neck—but not drown it. 'God is with us' (Immanuel) remains the hope. The chapter ends with darkness covering those who reject God's word."
      },
      {
        chapter: 9,
        eventIndex: 3,
        title: "A Child Is Born",
        note: "Light dawns on Galilee (later fulfilled in Jesus' ministry). The famous Messianic prophecy: 'For unto us a child is born... Wonderful Counselor, Mighty God, Everlasting Father, Prince of Peace.' But the chapter also pronounces judgment on Israel (the Northern Kingdom). Pride and unrepentance will bring Assyrian conquest. Israel falls in 722 BC."
      },
      {
        chapter: 10,
        eventIndex: 14,
        title: "Assyria: Rod and Victim",
        note: "God uses Assyria as 'the rod of My anger' against godless nations. But Assyria boasts: 'By my own strength I have done this!' So God will punish Assyria's arrogance. A remnant of Israel will return—but first, judgment. The map shows nations under Assyrian control, yet Assyria itself faces divine judgment for exceeding its mandate."
      },
      {
        chapter: 11,
        eventIndex: 18,
        title: "The Righteous Branch",
        note: "From Jesse's stump (David's line) a Branch grows—the Messiah. The Spirit rests on Him; He judges with righteousness. Wolves dwell with lambs; a child plays near serpents. God gathers scattered Israel from Assyria, Egypt, and beyond. Former enemies unite. This Messianic vision transcends any single historical moment."
      },
      {
        chapter: 12,
        eventIndex: 18,
        title: "Song of Salvation",
        note: "A short hymn of praise concludes the first major section of Isaiah. 'God is my salvation; I will trust and not be afraid.' The restored people draw water from wells of salvation and proclaim God's deeds among the nations. The Holy One of Israel dwells in Zion's midst. Judgment gives way to joy."
      },
      {
        chapter: 13,
        eventIndex: 15,
        title: "Oracle Against Babylon",
        note: "The 'burden against Babylon' begins Isaiah's oracles against the nations. Though Babylon is currently under Assyrian rule, Isaiah sees its future rise and fall. The Medes will attack; Babylon will become like Sodom—permanently desolate. This prophecy looks beyond Isaiah's day to 539 BC and beyond."
      },
      {
        chapter: 14,
        eventIndex: 15,
        title: "Babylon's King Falls",
        note: "A taunt-song against Babylon's king: 'How you have fallen from heaven, O Day Star!' The oppressor who shook kingdoms is brought down to Sheol. The chapter also includes a brief oracle against Philistia (v.28-32), warning them not to rejoice at Assyria's troubles—worse is coming."
      },
      {
        chapter: 15,
        eventIndex: 6,
        title: "Oracle Against Moab (Part 1)",
        note: "Moab, east of the Dead Sea, faces devastating judgment. Ar and Kir fall in a single night. The people flee, weeping. Isaiah himself mourns: 'My heart cries out for Moab!' Even in pronouncing judgment, the prophet shows compassion. Moab's pride will be humbled; her refugees seek shelter."
      },
      {
        chapter: 16,
        eventIndex: 6,
        title: "Oracle Against Moab (Part 2)",
        note: "The oracle continues: Moab should send tribute to Jerusalem and shelter Judah's outcasts. But Moab's pride prevents humility. 'We have heard of the pride of Moab—very proud.' Isaiah weeps for Moab's vineyards and joy. Within three years, Moab's glory will be contemptible. Yet a throne of steadfast love awaits in David's tent."
      },
      {
        chapter: 17,
        eventIndex: 2,
        title: "Oracle Against Damascus",
        note: "Damascus, capital of Aram (Syria), will become 'a heap of ruins.' The cities of Aroer are abandoned. Israel's glory also fades—only gleanings remain, like olives left after harvest. Yet 'in that day' people will look to their Maker. This prophecy found fulfillment in 732 BC under Tiglath-Pileser III."
      },
      {
        chapter: 18,
        eventIndex: 9,
        title: "Oracle Concerning Cush",
        note: "Cush (ancient Ethiopia/Nubia) sends envoys by papyrus boats on the Nile. God watches quietly as events unfold. Before harvest, He cuts down the shoots—Assyria's plans will fail. Eventually, gifts will come to Zion from this 'land of whirring wings.' Cush represents the distant nations God will ultimately reach."
      },
      {
        chapter: 19,
        eventIndex: 9,
        title: "Oracle Against Egypt",
        note: "The LORD rides a cloud into Egypt; her idols tremble. Civil war, drought, and foolish counsel afflict her. Yet the oracle ends remarkably: Egypt will know the LORD, worship Him, and be blessed alongside Assyria and Israel. 'Blessed be Egypt My people, Assyria My handiwork, and Israel My inheritance.' Enemies become family."
      },
      {
        chapter: 20,
        eventIndex: 9,
        title: "Sign Against Egypt and Cush",
        note: "Isaiah walks naked and barefoot for three years as a living sign: Assyria will lead away Egyptian and Cushite captives, naked and barefoot. Those who trusted in Egypt for help against Assyria will be dismayed. Judah must not rely on foreign alliances but on God alone."
      },
      {
        chapter: 21,
        eventIndex: 15,
        title: "Oracles: Babylon, Edom, Arabia",
        note: "Three brief oracles. 'The Desert by the Sea' (Babylon): 'Fallen, fallen is Babylon!' The watchman sees chariots coming. 'Dumah' (Edom): 'Watchman, what of the night?' Morning comes, but also night—Edom's future is uncertain. 'Arabia': Within a year, Kedar's glory fails. The caravans of Dedanites flee into the wilderness."
      },
      {
        chapter: 22,
        eventIndex: 12,
        title: "The Valley of Vision",
        note: "Jerusalem (the 'Valley of Vision') faces siege. The people prepare defenses but don't look to God. Instead of repentance, they feast: 'Let us eat and drink, for tomorrow we die!' Shebna the steward is demoted; Eliakim replaces him. The chapter reflects the crisis of Sennacherib's invasion in 701 BC."
      },
      {
        chapter: 23,
        eventIndex: 8,
        title: "Oracle Against Tyre",
        note: "Tyre, the great Phoenician trading city, will be laid waste. Ships of Tarshish wail; merchants who were 'princes' mourn. Tyre will be forgotten for seventy years, then restored—but her profits will be 'holy to the LORD,' used for those who dwell before Him. Even commercial power serves God's purposes."
      },
      {
        chapter: 24,
        eventIndex: null,
        title: "The LORD's Devastation",
        note: "The 'Little Apocalypse' begins. God devastates the whole earth—not just one nation. The earth mourns; wine fails; joy is gone. A remnant sings from the west, but Isaiah cries 'I waste away!' Cosmic upheaval: the moon is confounded, the sun ashamed. Yet the LORD of hosts will reign on Mount Zion in glory."
      },
      {
        chapter: 25,
        eventIndex: null,
        title: "Praise for God's Salvation",
        note: "A hymn of praise follows the apocalyptic vision. God has been a stronghold to the poor. On Mount Zion, He prepares a feast for all peoples and swallows up death forever. 'He will wipe away tears from all faces.' The reproach of His people is removed. 'This is the LORD; we have waited for Him!'"
      },
      {
        chapter: 26,
        eventIndex: null,
        title: "A Song of Trust",
        note: "Judah sings in 'that day': 'We have a strong city!' God keeps in perfect peace those whose minds are stayed on Him. The chapter moves between trust and longing. 'Your dead shall live; their bodies shall rise.' This resurrection hope sustains God's people through judgment. 'Come, my people, enter your chambers... until the fury has passed.'"
      },
      {
        chapter: 27,
        eventIndex: null,
        title: "Israel's Final Restoration",
        note: "God slays Leviathan, the twisting serpent. His vineyard (contrast chapter 5) He now tends carefully—no thorns or briers remain. Israel's guilt is atoned when altar stones are crushed. God gathers His people one by one from Assyria and Egypt. 'In that day a great trumpet will sound,' and the scattered worship in Jerusalem."
      },
      {
        chapter: 28,
        eventIndex: 3,
        title: "Woe to Ephraim",
        note: "Woe to the 'proud crown' of Ephraim (Israel/Samaria)—drunkards whose glorious beauty fades like a fig. Priests and prophets stagger. But God will lay in Zion a 'tested stone, a precious cornerstone.' Those who trust will not be in haste. Meanwhile, judgment comes like a flood. Israel's fall (722 BC) looms."
      },
      {
        chapter: 29,
        eventIndex: 12,
        title: "Woe to Ariel (Jerusalem)",
        note: "'Ariel' (lion of God) means Jerusalem, where David camped. God will besiege His own city—yet her enemies will vanish like a dream. The people honor God with lips but not hearts; their wisdom fails. Yet 'in that day' the deaf hear, the blind see, and the meek rejoice. Lebanon becomes a fruitful field."
      },
      {
        chapter: 30,
        eventIndex: 9,
        title: "Woe to Those Trusting Egypt",
        note: "Woe to rebellious children who seek Egypt's protection without consulting God! Pharaoh's help is worthless; Egypt is 'Rahab who sits still.' The people refuse to hear prophets. Yet God waits to be gracious—'Blessed are all who wait for Him.' When the people cry, God will answer. Assyria falls by a voice, not a sword."
      },
      {
        chapter: 31,
        eventIndex: 9,
        title: "Egypt Cannot Save",
        note: "Woe to those going to Egypt for horses and chariots! Egyptians are men, not God; their horses are flesh, not spirit. Yet the LORD will protect Jerusalem 'like birds hovering.' Assyria will fall 'by a sword not of man.' Israel must turn from idols. This chapter reinforces the futility of human alliances against divine purpose."
      },
      {
        chapter: 32,
        eventIndex: null,
        title: "The Righteous King",
        note: "A king will reign in righteousness; princes rule with justice. Eyes will see, ears will hear, and fools will no longer be honored. But first, complacent women must tremble—thorns will cover the pleasant fields. Only when the Spirit is poured from on high will the wilderness become fruitful. Righteousness brings peace and security."
      },
      {
        chapter: 33,
        eventIndex: 12,
        title: "Distress and Deliverance",
        note: "The destroyer (Assyria) will be destroyed. Jerusalem is in distress—envoys weep, highways are deserted. But God arises! He is the stability of Zion. The sinners in Zion tremble: 'Who among us can dwell with everlasting fire?' Those who walk righteously will see the king in his beauty and dwell securely."
      },
      {
        chapter: 34,
        eventIndex: 16,
        title: "Judgment on Edom",
        note: "God's fury falls on all nations, but especially Edom. The LORD has a sacrifice in Bozrah; the land becomes burning pitch. Wild animals inhabit the ruins. 'Seek and read from the book of the LORD'—not one creature will lack its mate. Edom's desolation is permanent, a testimony to divine judgment on those who oppose God's people."
      },
      {
        chapter: 35,
        eventIndex: 18,
        title: "The Ransomed Return",
        note: "The wilderness blooms; the desert rejoices! The glory of Lebanon and the majesty of Carmel appear. Weak hands are strengthened; fearful hearts made firm. 'Your God will come with vengeance, with divine recompense.' The blind see, the deaf hear, the lame leap, the mute sing. The ransomed return to Zion with everlasting joy."
      },
      {
        chapter: 36,
        eventIndex: 12,
        title: "Sennacherib Threatens Jerusalem",
        note: "In 701 BC, Sennacherib's army surrounds Jerusalem. The Rabshakeh mocks: 'Has any god delivered his land from my hand?' He lists conquered nations. Don't trust Hezekiah; don't trust the LORD. The people remain silent as commanded. This historical narrative (also in 2 Kings 18-19) shows the crisis at its peak."
      },
      {
        chapter: 37,
        eventIndex: 13,
        title: "Jerusalem Delivered",
        note: "Hezekiah tears his clothes, enters the temple, and sends to Isaiah. The prophet responds: 'Do not fear.' Sennacherib sends a threatening letter; Hezekiah spreads it before the LORD. Isaiah prophesies Assyria's defeat. That night, the Angel of the LORD strikes 185,000 Assyrians. Sennacherib retreats and is later murdered by his sons."
      },
      {
        chapter: 38,
        eventIndex: 13,
        title: "Hezekiah's Illness and Recovery",
        note: "Hezekiah falls deathly ill. Isaiah tells him to set his house in order. The king weeps and prays; God grants fifteen more years and promises to deliver Jerusalem. The sun's shadow goes backward as a sign. Hezekiah's psalm of thanksgiving follows: 'The living, the living, he thanks You, as I do this day.'"
      },
      {
        chapter: 39,
        eventIndex: 15,
        title: "Envoys from Babylon",
        note: "Merodach-Baladan of Babylon sends envoys after Hezekiah's recovery. The king shows them all his treasures—a foolish act. Isaiah pronounces judgment: everything will be carried to Babylon; Hezekiah's descendants will serve in Babylon's palace. This chapter bridges the Assyrian crisis to the coming Babylonian exile, pivoting Isaiah toward chapters 40-66."
      },
      {
        chapter: 40,
        eventIndex: 17,
        title: "Comfort My People",
        note: "'Comfort, comfort My people,' says God. Jerusalem's warfare is ended; her iniquity pardoned. A voice cries: 'Prepare the way of the LORD!' All flesh is grass, but God's word stands forever. The LORD comes with might, yet gently carries lambs. Who measured the waters? Who taught Him? The nations are a drop in a bucket. 'Fear not!'"
      },
      {
        chapter: 41,
        eventIndex: 17,
        title: "God's Chosen Servant",
        note: "God summons nations to court: 'Who stirred up one from the east?' (Cyrus, though unnamed). Idols cannot predict the future—they are wind and emptiness. But Israel is God's servant, chosen, not cast off. 'Fear not, for I am with you.' God makes Israel a threshing sledge. The poor seek water—God will not forsake them."
      },
      {
        chapter: 42,
        eventIndex: 17,
        title: "The Servant's Mission",
        note: "The first 'Servant Song': 'Behold My servant... I have put My Spirit upon Him.' He will not break a bruised reed. God calls Him to be 'a light for the nations, to open the eyes that are blind.' A new song arises! Yet Israel, God's servant, is blind and deaf. God gave them to plunderers because of sin, but redemption comes."
      },
      {
        chapter: 43,
        eventIndex: 17,
        title: "Fear Not, I Have Redeemed You",
        note: "'Fear not, for I have redeemed you; I have called you by name, you are Mine.' Through water and fire, God is with Israel. He gathers them from east and west. 'Before Me no god was formed, nor shall there be after Me. I, I am the LORD.' God makes a way in the sea—forget the former things! He does a new thing."
      },
      {
        chapter: 44,
        eventIndex: 17,
        title: "Israel Chosen, Idols Mocked",
        note: "God pours His Spirit on Israel's offspring. 'I am the first and the last; besides Me there is no god.' Idolaters are mocked: a man plants a tree, burns half for warmth, roasts meat, and makes the rest into a god! Yet God blots out Israel's sins like a cloud. Then the stunning prophecy: Cyrus is named—150 years early."
      },
      {
        chapter: 45,
        eventIndex: 17,
        title: "Cyrus, God's Anointed",
        note: "Cyrus is called God's 'anointed' (messiah)—the only Gentile so named. God takes his right hand, opens doors, breaks bronze gates. 'For the sake of Jacob My servant... I name you, though you do not know Me.' There is no God besides the LORD. Every knee will bow. Israel is saved with everlasting salvation."
      },
      {
        chapter: 46,
        eventIndex: 15,
        title: "Babylon's Gods Fall",
        note: "Bel bows down; Nebo stoops—Babylon's gods are carried on weary beasts. But God carries Israel from birth to gray hairs. 'To whom will you compare Me?' Idols are made by craftsmen—they cannot move or answer. God's purpose stands: 'I bring near My righteousness.' Salvation comes to Zion. Babylon's fall is certain."
      },
      {
        chapter: 47,
        eventIndex: 15,
        title: "The Fall of Babylon",
        note: "'Come down and sit in the dust, O virgin daughter of Babylon!' She showed Israel no mercy; she said 'I shall be mistress forever.' Her sorceries and enchantments will not save her. Disaster comes suddenly. This taunt-song over Babylon complements chapter 13-14. The empire that will exile Judah will itself face complete judgment."
      },
      {
        chapter: 48,
        eventIndex: 17,
        title: "Leave Babylon!",
        note: "Israel has been obstinate—'your neck is an iron sinew.' God declared things beforehand so Israel couldn't credit idols. Now He reveals new things. 'For My own sake, I do it.' God teaches what is profitable. 'If you had paid attention!' Yet mercy remains: 'Go out from Babylon!' The redeemed will not thirst; God leads them home."
      },
      {
        chapter: 49,
        eventIndex: null,
        title: "The Servant's Call",
        note: "The second Servant Song: 'The LORD called Me from the womb.' The Servant feels He has labored in vain, yet God makes Him 'a light for the nations, that My salvation may reach to the end of the earth.' Zion says, 'The LORD has forsaken me.' But can a mother forget her child? God's love is greater. Kings and queens bow to Israel."
      },
      {
        chapter: 50,
        eventIndex: null,
        title: "The Obedient Servant",
        note: "The third Servant Song: 'The Lord GOD has given Me the tongue of those who are taught.' The Servant gives His back to those who strike, His cheeks to those who pull out the beard. He sets His face like flint. 'Who will contend with Me?' Those walking in darkness should trust in the LORD's name."
      },
      {
        chapter: 51,
        eventIndex: null,
        title: "Comfort for Zion",
        note: "'Listen to Me, you who pursue righteousness.' Look to Abraham and Sarah—God blessed one and made him many. Zion's wilderness will become like Eden. 'My righteousness draws near.' The heavens vanish like smoke, but God's salvation is forever. 'Awake, awake!' The cup of staggering is taken from Jerusalem and given to her tormentors."
      },
      {
        chapter: 52,
        eventIndex: null,
        title: "Awake, O Zion!",
        note: "'Awake, put on your strength, O Zion!' Jerusalem shakes off her chains. 'How beautiful on the mountains are the feet of him who brings good news!' The LORD has comforted His people. Then the fourth Servant Song begins: 'My servant shall act wisely; He shall be high and lifted up'—yet His appearance was marred beyond recognition."
      },
      {
        chapter: 53,
        eventIndex: null,
        title: "The Suffering Servant",
        note: "The heart of Isaiah: 'He was despised and rejected... a man of sorrows.' He bore our griefs, carried our sorrows. 'He was pierced for our transgressions, crushed for our iniquities.' Like a lamb led to slaughter, He was silent. Though He had done no violence, He was cut off. Yet He sees His offspring; the LORD's will prospers in His hand."
      },
      {
        chapter: 54,
        eventIndex: null,
        title: "Zion's Future Glory",
        note: "'Sing, O barren one!' The desolate woman will have more children than the married. Enlarge your tent; your offspring will possess nations. God's love is like Noah's covenant—eternal. No weapon formed against Zion will prosper. 'This is the heritage of the servants of the LORD.' Affliction becomes adornment; mourning becomes joy."
      },
      {
        chapter: 55,
        eventIndex: null,
        title: "Invitation to the Thirsty",
        note: "'Come, everyone who thirsts, come to the waters!' Buy wine and milk without money. Why spend on what doesn't satisfy? Seek the LORD while He may be found. 'My thoughts are not your thoughts.' Rain accomplishes its purpose; so does God's word. The people go out with joy; mountains and trees clap their hands. Thorns give way to cypress."
      },
      {
        chapter: 56,
        eventIndex: null,
        title: "Salvation for All",
        note: "Justice and righteousness matter—sabbath-keeping and covenant-holding. Foreigners and eunuchs who join themselves to the LORD will not be excluded. God's house is 'a house of prayer for all peoples.' Yet Israel's watchmen are blind; her shepherds lack understanding. They love sleep and wine. This chapter bridges comfort and critique."
      },
      {
        chapter: 57,
        eventIndex: null,
        title: "The Righteous and the Wicked",
        note: "The righteous perish unnoticed; the wicked mock. Israel has played the harlot with idols, sacrificing children in valleys. Yet the high and lofty One 'dwells with him who is of a contrite and lowly spirit.' God heals and restores those who mourn. Peace to those far and near! But the wicked are like the tossing sea—no peace for them."
      },
      {
        chapter: 58,
        eventIndex: null,
        title: "True Fasting",
        note: "Israel fasts but oppresses workers. 'Is this the fast I choose?' No—loose the bonds of wickedness, share bread with the hungry, house the homeless. Then light breaks forth; healing comes. The sabbath is a delight, not a burden. God will feed Israel and rebuild ancient ruins. Religion without justice is empty ritual."
      },
      {
        chapter: 59,
        eventIndex: null,
        title: "Sin and Redemption",
        note: "God's hand is not too short to save, but 'your iniquities have made a separation.' Lies, violence, and injustice fill the land. Justice is far away; truth has fallen in the streets. God sees that there is no one to intervene—so His own arm brings salvation. He puts on righteousness as a breastplate. A Redeemer comes to Zion."
      },
      {
        chapter: 60,
        eventIndex: 18,
        title: "Arise, Shine!",
        note: "'Arise, shine, for your light has come!' Darkness covers the earth, but the LORD's glory rises upon Zion. Nations come to her light; kings to her brightness. Camels from Midian and Sheba bring gold and incense. The sons of foreigners build her walls. 'The sun shall be no more your light by day'—the LORD is everlasting light."
      },
      {
        chapter: 61,
        eventIndex: 18,
        title: "Good News to the Afflicted",
        note: "'The Spirit of the Lord GOD is upon Me, because He has anointed Me to bring good news to the poor.' Jesus read this in Nazareth's synagogue. Liberty for captives; comfort for mourners; beauty for ashes. God's people become 'oaks of righteousness.' They rebuild ancient ruins. An everlasting covenant is established. Zion rejoices like a bride."
      },
      {
        chapter: 62,
        eventIndex: 18,
        title: "Zion's Vindication",
        note: "Isaiah will not rest until Zion's righteousness shines. She receives a new name: 'My Delight Is in Her' and 'Married.' Watchmen on Jerusalem's walls give God no rest until He establishes the city. 'Go through the gates! Prepare the way!' The LORD proclaims to Zion: 'Your salvation comes.' She will be called 'Sought Out.'"
      },
      {
        chapter: 63,
        eventIndex: null,
        title: "The Divine Warrior",
        note: "'Who is this coming from Edom, in crimsoned garments?' The LORD has trodden the winepress alone; His robes are stained with judgment. Then a long prayer begins: God led Israel through the sea; His Holy Spirit was in their midst. 'You are our Father, our Redeemer.' Where now are Your zeal and might? Your people possess the sanctuary so briefly."
      },
      {
        chapter: 64,
        eventIndex: null,
        title: "A Prayer for Mercy",
        note: "'Oh that You would rend the heavens and come down!' Mountains quake before God. No eye has seen a God like Him, who acts for those who wait. Yet 'we have all become like one who is unclean.' We fade like leaves; our iniquities carry us away. 'Be not so terribly angry, O LORD!' Zion is desolate; the temple is burned."
      },
      {
        chapter: 65,
        eventIndex: 18,
        title: "New Heavens and New Earth",
        note: "God was ready to be found by those who didn't seek Him. But Israel provoked Him with idols and self-righteousness. A remnant survives—His servants inherit the land. 'Behold, I create new heavens and a new earth.' Jerusalem becomes a joy; the wolf and lamb feed together. No more weeping; no more infant death. God answers before they call."
      },
      {
        chapter: 66,
        eventIndex: 18,
        title: "The LORD's Final Triumph",
        note: "Heaven is God's throne, earth His footstool—what house can contain Him? He looks to the humble and contrite. Those who worship wrongly bring abominations. Jerusalem gives birth suddenly; her children are comforted. God's enemies face fire and judgment. 'All flesh shall come to worship before Me.' Isaiah ends with new creation and eternal worship."
      }
    ];

    // Empire/Conquering power colors
    const empireColors = {
      assyria: "#7a8c72",      // Olive green (like the reference map)
      babylon: "#8b7355",      // Brown
      persia: "#6b8e9f",       // Blue-grey for Medo-Persian
      independent: "original", // Use nation's own color
      divine: "#D4AF37"        // Gold for divine judgment
    };

    // Nation data with more accurate geography based on reference map
    const nations = {
      // Major empires
      assyria: { 
        name: "Assyria", 
        labelX: 68, labelY: 25,
        cityX: 72, cityY: 20, cityName: "Nineveh",
        color: "#7a8c72",
        // Large territory - upper Mesopotamia
        path: "M 50 8 L 62 5 L 78 8 L 88 15 L 90 28 L 85 38 L 78 42 L 70 40 L 62 42 L 55 38 L 48 30 L 45 20 L 48 12 Z"
      },
      babylon: { 
        name: "Babylon", 
        labelX: 78, labelY: 52,
        cityX: 75, cityY: 48, cityName: "Babylon",
        color: "#8b7355",
        // Lower Mesopotamia
        path: "M 62 42 L 70 40 L 78 42 L 85 38 L 92 45 L 95 58 L 88 68 L 78 65 L 70 62 L 65 55 L 62 48 Z"
      },
      media: {
        name: "Media",
        labelX: 88, labelY: 28,
        color: "#9a9a7a",
        // East of Assyria
        path: "M 88 15 L 98 12 L 100 25 L 98 38 L 92 42 L 85 38 L 90 28 Z",
        contextOnly: true
      },
      elam: {
        name: "Elam",
        labelX: 92, labelY: 55,
        color: "#8a9a8a",
        // Southeast of Babylon
        path: "M 92 45 L 100 42 L 100 65 L 95 70 L 88 68 L 95 58 Z",
        contextOnly: true
      },
      
      // Levantine nations (from north to south along coast)
      aram: { 
        name: "Aram", 
        labelX: 42, labelY: 32,
        cityX: 48, cityY: 35, cityName: "Damascus",
        color: "#6b8b6b",
        // Syria/Aram - inland from Phoenicia
        path: "M 38 25 L 48 22 L 55 28 L 55 38 L 48 42 L 40 40 L 35 32 Z"
      },
      phoenicia: { 
        name: "Phoenicia", 
        labelX: 30, labelY: 32,
        cityX: 28, cityY: 35, cityName: "Tyre",
        color: "#4a6a8a",
        // Coastal strip - Tyre, Sidon
        path: "M 25 25 L 32 24 L 35 28 L 35 40 L 32 44 L 25 42 L 22 35 Z"
      },
      israel: { 
        name: "Israel", 
        labelX: 30, labelY: 44,
        cityX: 28, cityY: 46, cityName: "Samaria",
        color: "#5a7a5a",
        // Northern kingdom - includes Galilee down to roughly Samaria
        path: "M 25 42 L 32 44 L 35 40 L 40 40 L 42 46 L 38 52 L 32 52 L 25 48 Z"
      },
      ammon: {
        name: "Ammon",
        labelX: 45, labelY: 50,
        color: "#7a6a5a",
        // East of Jordan, north of Moab
        path: "M 42 46 L 48 42 L 55 45 L 55 52 L 48 56 L 42 54 L 38 52 Z"
      },
      judah: {
        name: "Judah",
        labelX: 28, labelY: 58,
        cityX: 30, cityY: 55, cityName: "Jerusalem",
        color: "#D4AF37",
        // Southern kingdom - smaller than Israel
        path: "M 25 52 L 32 52 L 38 52 L 42 54 L 40 62 L 35 68 L 28 66 L 22 60 Z",
        isJudah: true
      },
      philistia: { 
        name: "Philistia", 
        labelX: 20, labelY: 55,
        cityX: 18, cityY: 52, cityName: "Ashdod",
        color: "#5a6a4a",
        // Coastal plain southwest of Judah
        path: "M 15 48 L 22 46 L 25 48 L 25 52 L 22 60 L 18 62 L 12 58 L 12 52 Z"
      },
      moab: { 
        name: "Moab", 
        labelX: 45, labelY: 62,
        cityX: 44, cityY: 58, cityName: "Ar",
        color: "#8a7a6a",
        // East of Dead Sea
        path: "M 42 54 L 48 56 L 52 60 L 50 68 L 44 72 L 38 70 L 35 68 L 40 62 Z"
      },
      edom: { 
        name: "Edom", 
        labelX: 38, labelY: 78,
        cityX: 40, cityY: 75, cityName: "Bozrah",
        color: "#9a6a5a",
        // South of Moab and Judah
        path: "M 28 66 L 35 68 L 44 72 L 48 78 L 42 85 L 32 88 L 25 82 L 22 74 Z"
      },
      
      // Southern nations
      egypt: { 
        name: "Egypt", 
        labelX: 12, labelY: 72,
        cityX: 8, cityY: 78, cityName: "Memphis",
        color: "#6a8a6a",
        // Nile delta and valley
        path: "M 2 55 L 12 52 L 12 58 L 18 62 L 20 70 L 18 80 L 12 90 L 5 95 L 2 88 Z"
      },
      cush: { 
        name: "Cush", 
        labelX: 15, labelY: 95,
        color: "#5a5a4a",
        // South of Egypt
        path: "M 5 95 L 12 90 L 22 92 L 35 98 L 2 98 Z"
      },
      arabia: { 
        name: "Arabia", 
        labelX: 55, labelY: 85,
        cityX: 50, cityY: 78, cityName: "Dumah",
        color: "#c4a882",
        // Large desert area
        path: "M 32 88 L 42 85 L 48 78 L 55 75 L 70 72 L 78 78 L 75 92 L 55 98 L 35 98 L 22 92 Z"
      }
    };

    // Jerusalem marker position
    const jerusalem = { x: 30, y: 55, name: "Jerusalem" };

    // Dead Sea position
    const deadSea = { x: 38, y: 58, width: 3, height: 10 };

    const events = [
      {
        id: 0, title: "The Nations Before Judgment", year: "~740 BC",
        description: "Isaiah begins his prophetic ministry during the reign of Uzziah. The ancient Near East is a patchwork of kingdoms—Assyria rising in the north, Egypt enduring in the south, and the small kingdoms caught between.",
        scripture: "Isaiah 1:1",
        scriptureText: "The vision of Isaiah the son of Amoz, which he saw concerning Judah and Jerusalem in the days of Uzziah, Jotham, Ahaz, and Hezekiah, kings of Judah.",
        conqueredBy: {}, // nation: conqueror
        highlights: ['judah'],
        arrows: []
      },
      {
        id: 1, title: "Assyria: Rod of God's Anger", year: "~735 BC",
        description: "God raises Assyria as His instrument of judgment. The empire's armies begin their march southward. Though Assyria acts from pride and greed, unknowingly they serve the Lord's purposes.",
        scripture: "Isaiah 10:5-7",
        scriptureText: "Woe to Assyria, the rod of My anger and the staff in whose hand is My indignation. I will send him against an ungodly nation...",
        conqueredBy: {},
        highlights: ['assyria'],
        arrows: [{from: {x: 68, y: 25}, to: {x: 48, y: 35}, color: '#7a8c72'}]
      },
      {
        id: 2, title: "Damascus Falls", year: "732 BC",
        description: "Aram's capital Damascus falls to Tiglath-Pileser III. The city that conspired with Israel against Judah becomes a ruinous heap. Assyria's shadow lengthens over the Levant.",
        scripture: "Isaiah 17:1-3",
        scriptureText: "Behold, Damascus will cease from being a city, and it will be a ruinous heap. The cities of Aroer are forsaken...",
        conqueredBy: { aram: 'assyria' },
        highlights: ['aram', 'assyria'],
        arrows: [{from: {x: 68, y: 28}, to: {x: 42, y: 32}, color: '#7a8c72'}],
        conquestText: "Damascus falls to Assyria"
      },
      {
        id: 3, title: "Israel Conquered", year: "722 BC",
        description: "The Northern Kingdom falls to Shalmaneser V and Sargon II. The ten tribes are scattered across the Assyrian empire. Now Assyria's border touches Judah directly from the north.",
        scripture: "Isaiah 9:8-12; 10:11",
        scriptureText: "The Lord sent a word against Jacob, and it has fallen on Israel... Shall I not do to Jerusalem and her idols as I have done to Samaria and her idols?",
        conqueredBy: { aram: 'assyria', israel: 'assyria' },
        highlights: ['israel', 'judah'],
        arrows: [{from: {x: 55, y: 32}, to: {x: 30, y: 44}, color: '#7a8c72'}],
        conquestText: "Israel conquered—Samaria falls to Assyria"
      },
      {
        id: 4, title: "Babylon Conquered", year: "710 BC",
        description: "Sargon II marches on Babylon, ousting the rebel king Merodach-Baladan. The ancient city falls under Assyrian rule. Sargon takes the title 'King of Babylon' and rules from Marduk's throne for three years.",
        scripture: "Isaiah 14:4-6",
        scriptureText: "You will take up this proverb against the king of Babylon, and say: 'How the oppressor has ceased, the golden city ceased! The LORD has broken the staff of the wicked, the scepter of the rulers.'",
        conqueredBy: { aram: 'assyria', israel: 'assyria', babylon: 'assyria' },
        highlights: ['babylon', 'assyria'],
        arrows: [{from: {x: 68, y: 32}, to: {x: 78, y: 52}, color: '#7a8c72'}],
        conquestText: "Babylon falls to Sargon II—Assyria rules all Mesopotamia"
      },
      {
        id: 5, title: "Philistia Subjugated", year: "~711 BC",
        description: "The Philistine cities—Gaza, Ashkelon, Ashdod, Ekron—fall under Assyrian dominion. Judah's western flank is now exposed. The coastal route to Egypt lies in Assyrian hands.",
        scripture: "Isaiah 14:28-31",
        scriptureText: "Do not rejoice, all you of Philistia, because the rod that struck you is broken; for out of the serpent's roots will come forth a viper...",
        conqueredBy: { aram: 'assyria', israel: 'assyria', babylon: 'assyria', philistia: 'assyria' },
        highlights: ['philistia', 'judah'],
        arrows: [{from: {x: 55, y: 35}, to: {x: 20, y: 55}, color: '#7a8c72'}],
        conquestText: "Philistia falls under Assyrian control"
      },
      {
        id: 6, title: "Moab's Devastation", year: "~709 BC",
        description: "Moab, east of the Dead Sea, faces utter devastation. Isaiah weeps over their destruction—'my heart cries out for Moab'—showing God's compassion even in judgment.",
        scripture: "Isaiah 15:1-5; 16:11",
        scriptureText: "In the night Ar of Moab is laid waste and destroyed... Therefore my heart shall resound like a harp for Moab, and my inner being for Kir Heres.",
        conqueredBy: { aram: 'assyria', israel: 'assyria', babylon: 'assyria', philistia: 'assyria', moab: 'assyria' },
        highlights: ['moab', 'judah'],
        arrows: [{from: {x: 62, y: 42}, to: {x: 45, y: 62}, color: '#7a8c72'}],
        conquestText: "Moab devastated"
      },
      {
        id: 7, title: "Ammon Under the Shadow", year: "~709 BC",
        description: "Ammon, the children of Lot east of the Jordan, cannot escape Assyria's reach. Another buffer between Judah and the empire crumbles.",
        scripture: "Isaiah 11:14",
        scriptureText: "They shall plunder the people of the East together; they shall lay their hand on Edom and Moab, and the people of Ammon shall obey them.",
        conqueredBy: { aram: 'assyria', israel: 'assyria', babylon: 'assyria', philistia: 'assyria', moab: 'assyria', ammon: 'assyria' },
        highlights: ['ammon', 'judah'],
        arrows: [{from: {x: 62, y: 40}, to: {x: 45, y: 50}, color: '#7a8c72'}],
        conquestText: "Ammon falls under Assyrian dominion"
      },
      {
        id: 8, title: "Phoenicia's Pride Broken", year: "~709 BC",
        description: "Tyre and Sidon, the great merchant cities of Phoenicia, are humbled. Their ships once ruled the Mediterranean; now they pay tribute to Nineveh. Tyre will be forgotten for seventy years.",
        scripture: "Isaiah 23:1-5, 15",
        scriptureText: "Wail, O ships of Tarshish! For Tyre is laid waste... It will be in that day that Tyre will be forgotten seventy years.",
        conqueredBy: { aram: 'assyria', israel: 'assyria', babylon: 'assyria', philistia: 'assyria', moab: 'assyria', ammon: 'assyria', phoenicia: 'assyria' },
        highlights: ['phoenicia', 'judah'],
        arrows: [{from: {x: 55, y: 30}, to: {x: 30, y: 32}, color: '#7a8c72'}],
        conquestText: "Tyre and Sidon submit to Assyria"
      },
      {
        id: 9, title: "Egypt and Cush Threatened", year: "~714 BC",
        description: "Isaiah walks naked and barefoot for three years as a sign: Egypt and Cush, though powerful, will be led away as captives. Judah must not trust in their alliance.",
        scripture: "Isaiah 20:3-4",
        scriptureText: "Just as My servant Isaiah has walked naked and barefoot three years for a sign... so shall the king of Assyria lead away the Egyptians as prisoners.",
        conqueredBy: { aram: 'assyria', israel: 'assyria', babylon: 'assyria', philistia: 'assyria', moab: 'assyria', ammon: 'assyria', phoenicia: 'assyria' },
        highlights: ['egypt', 'cush', 'judah'],
        arrows: [{from: {x: 55, y: 38}, to: {x: 12, y: 72}, color: '#7a8c72', style: 'dashed'}],
        threatened: ['egypt', 'cush']
      },
      {
        id: 10, title: "Arabia's Burden", year: "~700 BC",
        description: "Even the desert tribes cannot hide from judgment. The caravans of Dedanites flee, the glory of Kedar fails. Within a year, the Arabian tribes bow to Assyria.",
        scripture: "Isaiah 21:13-17",
        scriptureText: "The burden against Arabia... Within a year, according to the years of a hired man, all the glory of Kedar will fail.",
        conqueredBy: { aram: 'assyria', israel: 'assyria', babylon: 'assyria', philistia: 'assyria', moab: 'assyria', ammon: 'assyria', phoenicia: 'assyria', arabia: 'assyria' },
        highlights: ['arabia', 'judah'],
        arrows: [{from: {x: 62, y: 45}, to: {x: 55, y: 85}, color: '#7a8c72'}],
        conquestText: "Arabia's tribes submit"
      },
      {
        id: 11, title: "Edom Falls", year: "~700 BC",
        description: "Edom, the descendants of Esau south of the Dead Sea, falls under Assyrian control. Judah is now completely encircled—an island of gold in a sea of Assyrian olive.",
        scripture: "Isaiah 21:11-12",
        scriptureText: "The burden against Dumah: He calls to me out of Seir, 'Watchman, what of the night? Watchman, what of the night?'",
        conqueredBy: { aram: 'assyria', israel: 'assyria', babylon: 'assyria', philistia: 'assyria', moab: 'assyria', ammon: 'assyria', phoenicia: 'assyria', arabia: 'assyria', edom: 'assyria' },
        highlights: ['edom', 'judah'],
        arrows: [{from: {x: 55, y: 55}, to: {x: 38, y: 78}, color: '#7a8c72'}],
        conquestText: "Edom falls—Judah now completely surrounded!"
      },
      {
        id: 12, title: "The Siege of Jerusalem", year: "701 BC",
        description: "Sennacherib's army surrounds Jerusalem. The Rabshakeh mocks: 'Has any god delivered his land from my hand?' Every nation has fallen. But Hezekiah spreads the letter before the LORD and prays...",
        scripture: "Isaiah 36:18-20; 37:14-20",
        scriptureText: "Do not let Hezekiah deceive you... Where are the gods of Hamath and Arpad? Where are the gods of Sepharvaim? Have they delivered Samaria from my hand?",
        conqueredBy: { aram: 'assyria', israel: 'assyria', babylon: 'assyria', philistia: 'assyria', moab: 'assyria', ammon: 'assyria', phoenicia: 'assyria', arabia: 'assyria', edom: 'assyria' },
        highlights: ['judah', 'assyria'],
        arrows: [{from: {x: 68, y: 30}, to: {x: 30, y: 55}, color: '#7a8c72', blocked: true}],
        siege: true
      },
      {
        id: 13, title: "The Angel of the LORD", year: "701 BC",
        description: "In one night, the Angel of the LORD strikes 185,000 Assyrians. The empire that swallowed nations meets its limit at Zion's walls. Jerusalem stands—the only unconquered city.",
        scripture: "Isaiah 37:36-38",
        scriptureText: "Then the angel of the LORD went out, and killed in the camp of the Assyrians one hundred and eighty-five thousand; and when people arose early in the morning, there were the corpses—all dead.",
        conqueredBy: { aram: 'assyria', israel: 'assyria', babylon: 'assyria', philistia: 'assyria', moab: 'assyria', ammon: 'assyria', phoenicia: 'assyria', arabia: 'assyria', edom: 'assyria' },
        highlights: ['judah'],
        divineVictory: true,
        victory: true
      },
      {
        id: 14, title: "Assyria's Own Judgment", year: "~700 BC (Prophesied)",
        description: "The rod of God's anger will itself be broken. Assyria's arrogance in exceeding its mandate brings divine judgment. The empire will fall—not to another army, but to God's decree.",
        scripture: "Isaiah 10:12-19",
        scriptureText: "When the Lord has performed all His work on Mount Zion and on Jerusalem, He will punish the fruit of the arrogant heart of the king of Assyria, and the glory of his haughty looks.",
        conqueredBy: { aram: 'assyria', israel: 'assyria', babylon: 'assyria', philistia: 'assyria', moab: 'assyria', ammon: 'assyria', phoenicia: 'assyria', arabia: 'assyria', edom: 'assyria' },
        highlights: ['assyria'],
        divineJudgment: 'assyria',
        futureEvent: true
      },
      {
        id: 15, title: "Babylon's Rise Foretold", year: "~700 BC (Prophesied)",
        description: "Though currently under Assyrian rule, Isaiah sees Babylon's future rise. Merodach-Baladan's embassy to Hezekiah (Isaiah 39) foreshadows this—Babylon will break free, conquer Assyria, and even take Judah captive.",
        scripture: "Isaiah 13:1, 17-19; 39:5-7",
        scriptureText: "The burden against Babylon... Behold, I will stir up the Medes against them... And Babylon, the glory of kingdoms, will be as when God overthrew Sodom and Gomorrah.",
        conqueredBy: { aram: 'assyria', israel: 'assyria', babylon: 'assyria', philistia: 'assyria', moab: 'assyria', ammon: 'assyria', phoenicia: 'assyria', arabia: 'assyria', edom: 'assyria' },
        highlights: ['babylon', 'media'],
        futureEvent: true,
        futureRise: 'babylon'
      },
      {
        id: 16, title: "Edom's Final Desolation", year: "Prophesied",
        description: "Edom faces permanent devastation by divine judgment. The ancient enmity between Esau and Jacob reaches its final conclusion. Bozrah's smoke will rise forever.",
        scripture: "Isaiah 34:5-10",
        scriptureText: "My sword shall be bathed in heaven; indeed it shall come down on Edom... Its land shall become burning pitch; it shall not be quenched night or day.",
        conqueredBy: { aram: 'assyria', israel: 'assyria', babylon: 'assyria', philistia: 'assyria', moab: 'assyria', ammon: 'assyria', phoenicia: 'assyria', arabia: 'assyria', edom: 'divine' },
        highlights: ['edom'],
        divineJudgment: 'edom',
        futureEvent: true
      },
      {
        id: 17, title: "Cyrus: God's Anointed", year: "539 BC (Prophesied)",
        description: "150 years before his birth, Isaiah names Cyrus as God's anointed shepherd. The Persian king will conquer Babylon and decree: 'Let God's people return to Jerusalem.'",
        scripture: "Isaiah 44:28; 45:1-4",
        scriptureText: "Who says of Cyrus, 'He is My shepherd, and he shall perform all My pleasure,' saying to Jerusalem, 'You shall be built,' and to the temple, 'Your foundation shall be laid.'",
        conqueredBy: { aram: 'persia', israel: 'persia', philistia: 'persia', moab: 'persia', ammon: 'persia', phoenicia: 'persia', arabia: 'persia', edom: 'persia', babylon: 'persia', assyria: 'persia' },
        highlights: ['babylon', 'judah', 'media'],
        futureEvent: true,
        conquestText: "Babylon falls to Cyrus—God's people will return!"
      },
      {
        id: 18, title: "Zion Restored: All Nations Stream", year: "The Messianic Age",
        description: "The ultimate vision: the mountain of the LORD established above all. Nations that once warred now stream to Zion to learn God's ways. Swords become plowshares; spears become pruning hooks.",
        scripture: "Isaiah 2:2-4; 60:1-3",
        scriptureText: "Now it shall come to pass in the latter days that the mountain of the LORD's house shall be established on the top of the mountains... and all nations shall flow to it.",
        conqueredBy: {},
        highlights: ['judah'],
        restoration: true,
        allNationsToZion: true
      }
    ];

    // Map Component
    const AncientMap = ({ conqueredBy, highlights, arrows, divineJudgment, futureEvent, restoration, allNationsToZion, siege, victory, threatened, futureRise, divineVictory }) => {
      
      const getTerritoryFill = (nationKey, nation) => {
        if (restoration) return nation.color;
        if (divineJudgment === nationKey) return '#ff6b35';
        if (futureRise === nationKey) return nation.color;
        
        const conqueror = conqueredBy[nationKey];
        if (conqueror === 'assyria') return empireColors.assyria;
        if (conqueror === 'babylon') return empireColors.babylon;
        if (conqueror === 'persia') return empireColors.persia;
        if (conqueror === 'divine') return '#4a2a2a';
        
        return nation.color;
      };

      const getTerritoryStroke = (nationKey, nation) => {
        if (highlights.includes(nationKey)) return '#D4AF37';
        if (conqueredBy[nationKey]) return '#2a2a2a';
        return '#3d2e1e';
      };

      const getTerritoryStrokeWidth = (nationKey) => {
        if (highlights.includes(nationKey)) return 1.2;
        return 0.5;
      };

      // Count conquests for display
      const assyrianTerritories = Object.values(conqueredBy).filter(c => c === 'assyria').length;
      
      return (
        <svg viewBox="0 0 100 100" className="w-full h-full">
          <defs>
            <filter id="glow">
              <feGaussianBlur stdDeviation="0.8" result="coloredBlur"/>
              <feMerge><feMergeNode in="coloredBlur"/><feMergeNode in="SourceGraphic"/></feMerge>
            </filter>
            <filter id="strongGlow">
              <feGaussianBlur stdDeviation="1.5" result="coloredBlur"/>
              <feMerge><feMergeNode in="coloredBlur"/><feMergeNode in="SourceGraphic"/></feMerge>
            </filter>
            <radialGradient id="fireGradient">
              <stop offset="0%" stopColor="#ff6b35"/>
              <stop offset="50%" stopColor="#f72c25"/>
              <stop offset="100%" stopColor="#2d0c0c"/>
            </radialGradient>
            <radialGradient id="victoryGlow">
              <stop offset="0%" stopColor="#ffd700"/>
              <stop offset="50%" stopColor="#D4AF37"/>
              <stop offset="100%" stopColor="transparent"/>
            </radialGradient>
            <marker id="arrowhead" markerWidth="4" markerHeight="3" refX="3.5" refY="1.5" orient="auto">
              <polygon points="0 0, 4 1.5, 0 3" fill="#2d1810"/>
            </marker>
            <marker id="arrowhead-gold" markerWidth="4" markerHeight="3" refX="3.5" refY="1.5" orient="auto">
              <polygon points="0 0, 4 1.5, 0 3" fill="#D4AF37"/>
            </marker>
            <marker id="arrowhead-persia" markerWidth="4" markerHeight="3" refX="3.5" refY="1.5" orient="auto">
              <polygon points="0 0, 4 1.5, 0 3" fill="#3d5a6a"/>
            </marker>
          </defs>
          
          {/* Background - land */}
          <rect width="100" height="100" fill="#d4c4a8"/>
          
          {/* Mediterranean Sea */}
          <path d="M 0 15 Q 8 18, 15 22 Q 22 28, 22 35 Q 20 45, 12 52 L 0 52 Z" fill="#7fb5c9" opacity="0.7"/>
          
          {/* Persian Gulf */}
          <path d="M 95 55 Q 100 60, 100 75 L 95 75 Q 92 65, 88 60 Z" fill="#7fb5c9" opacity="0.6"/>
          
          {/* Red Sea */}
          <path d="M 15 80 Q 18 88, 15 100 L 10 100 Q 12 88, 10 80 Z" fill="#7fb5c9" opacity="0.6"/>
          
          {/* Dead Sea */}
          <ellipse cx={deadSea.x} cy={deadSea.y} rx={deadSea.width/2} ry={deadSea.height/2} fill="#5a9ab0" opacity="0.8"/>
          
          {/* Sea of Galilee */}
          <ellipse cx="35" cy="42" rx="1.5" ry="2.5" fill="#7fb5c9" opacity="0.8"/>
          
          {/* Nile River */}
          <path d="M 12 55 Q 10 65, 12 75 Q 8 85, 10 100" stroke="#7fb5c9" strokeWidth="1.5" fill="none" opacity="0.8"/>
          <path d="M 12 55 Q 8 58, 5 62" stroke="#7fb5c9" strokeWidth="1" fill="none" opacity="0.6"/>
          
          {/* Tigris & Euphrates */}
          <path d="M 60 5 Q 68 20, 75 35 Q 80 50, 88 65" stroke="#7fb5c9" strokeWidth="1" fill="none" opacity="0.7"/>
          <path d="M 52 5 Q 62 20, 70 38 Q 78 52, 85 68" stroke="#7fb5c9" strokeWidth="1" fill="none" opacity="0.7"/>
          
          {/* Jordan River */}
          <path d="M 35 44 Q 37 50, 38 55" stroke="#7fb5c9" strokeWidth="0.6" fill="none" opacity="0.7"/>
          
          {/* All nations to Zion lines */}
          {allNationsToZion && Object.entries(nations).filter(([key]) => !nations[key].contextOnly).map(([key, nation], index) => (
            <g key={`stream-${key}`}>
              {/* Glow/outline for visibility */}
              <path
                d={`M ${nation.labelX} ${nation.labelY} L ${jerusalem.x} ${jerusalem.y}`}
                stroke="#fff8e0"
                strokeWidth="1.5"
                fill="none"
                opacity="0.4"
                strokeLinecap="round"
              />
              {/* Main streaming line */}
              <path
                d={`M ${nation.labelX} ${nation.labelY} L ${jerusalem.x} ${jerusalem.y}`}
                stroke="#D4AF37"
                strokeWidth="0.8"
                fill="none"
                opacity="0.9"
                strokeDasharray="3,2"
                markerEnd="url(#arrowhead-gold)"
                strokeLinecap="round"
              >
                <animate attributeName="stroke-dashoffset" from="0" to="-15" dur="2s" repeatCount="indefinite" begin={`${index * 0.1}s`}/>
              </path>
            </g>
          ))}
          
          {/* Draw territories */}
          {Object.entries(nations).map(([key, nation]) => (
            <g key={key}>
              {/* Territory fill */}
              <path
                d={nation.path}
                fill={getTerritoryFill(key, nation)}
                opacity={nation.contextOnly ? 0.4 : 0.75}
                stroke={getTerritoryStroke(key, nation)}
                strokeWidth={getTerritoryStrokeWidth(key)}
                strokeDasharray={threatened && threatened.includes(key) ? "2,1" : "none"}
                className="territory-path"
              />
              
              {/* Highlight glow for selected nations */}
              {highlights.includes(key) && (
                <path
                  d={nation.path}
                  fill="none"
                  stroke="#D4AF37"
                  strokeWidth="2"
                  opacity="0.5"
                  filter="url(#glow)"
                />
              )}
              
              {/* Divine judgment fire */}
              {divineJudgment === key && (
                <path d={nation.path} fill="url(#fireGradient)" opacity="0.6">
                  <animate attributeName="opacity" values="0.4;0.7;0.4" dur="1s" repeatCount="indefinite"/>
                </path>
              )}
              
              {/* Future rise indicator */}
              {futureRise === key && (
                <path d={nation.path} fill="none" stroke="#8b7355" strokeWidth="1.5" strokeDasharray="4,2" opacity="0.8">
                  <animate attributeName="stroke-dashoffset" from="0" to="-12" dur="2s" repeatCount="indefinite"/>
                </path>
              )}
            </g>
          ))}
          
          {/* Siege around Jerusalem */}
          {siege && (
            <g>
              <circle cx={jerusalem.x} cy={jerusalem.y} r="10" fill="none" stroke="#7a8c72" strokeWidth="1.5" strokeDasharray="3,2" opacity="0.9">
                <animate attributeName="stroke-dashoffset" from="0" to="-10" dur="1s" repeatCount="indefinite"/>
              </circle>
              <circle cx={jerusalem.x} cy={jerusalem.y} r="13" fill="none" stroke="#7a8c72" strokeWidth="0.8" strokeDasharray="2,2" opacity="0.6">
                <animate attributeName="stroke-dashoffset" from="0" to="8" dur="1.5s" repeatCount="indefinite"/>
              </circle>
              {/* Army markers */}
              {[30, 90, 150, 210, 270, 330].map((angle, i) => {
                const rad = (angle * Math.PI) / 180;
                const x = jerusalem.x + Math.cos(rad) * 12;
                const y = jerusalem.y + Math.sin(rad) * 12;
                return (
                  <g key={i}>
                    <circle cx={x} cy={y} r="1.2" fill="#7a8c72" opacity="0.9">
                      <animate attributeName="r" values="1;1.5;1" dur="1s" repeatCount="indefinite" begin={`${i * 0.15}s`}/>
                    </circle>
                  </g>
                );
              })}
            </g>
          )}
          
          {/* Divine victory effect */}
          {(victory || divineVictory) && (
            <g>
              <circle cx={jerusalem.x} cy={jerusalem.y} r="15" fill="url(#victoryGlow)" opacity="0.5">
                <animate attributeName="r" values="12;18;12" dur="2s" repeatCount="indefinite"/>
                <animate attributeName="opacity" values="0.3;0.6;0.3" dur="2s" repeatCount="indefinite"/>
              </circle>
              {/* Light rays */}
              {[0, 45, 90, 135, 180, 225, 270, 315].map((angle, i) => {
                const rad = (angle * Math.PI) / 180;
                const x1 = jerusalem.x + Math.cos(rad) * 4;
                const y1 = jerusalem.y + Math.sin(rad) * 4;
                const x2 = jerusalem.x + Math.cos(rad) * 18;
                const y2 = jerusalem.y + Math.sin(rad) * 18;
                return (
                  <line key={i} x1={x1} y1={y1} x2={x2} y2={y2} stroke="#D4AF37" strokeWidth="0.6" opacity="0.7">
                    <animate attributeName="opacity" values="0.4;0.9;0.4" dur="1.5s" repeatCount="indefinite" begin={`${i * 0.1}s`}/>
                  </line>
                );
              })}
            </g>
          )}
          
          {/* Restoration mega glow */}
          {restoration && (
            <g>
              <circle cx={jerusalem.x} cy={jerusalem.y} r="30" fill="url(#victoryGlow)" opacity="0.3">
                <animate attributeName="r" values="25;35;25" dur="3s" repeatCount="indefinite"/>
              </circle>
            </g>
          )}
          
          {/* Conquest arrows */}
          {arrows && arrows.map((arrow, i) => {
            const midX = (arrow.from.x + arrow.to.x) / 2;
            const midY = (arrow.from.y + arrow.to.y) / 2 - 4;
            const isPersia = arrow.color === '#6b8e9f';
            const pathD = `M ${arrow.from.x} ${arrow.from.y} Q ${midX} ${midY}, ${arrow.to.x} ${arrow.to.y}`;
            return (
              <g key={i}>
                {/* Arrow outline for visibility */}
                <path
                  d={pathD}
                  stroke="#f4e4bc"
                  strokeWidth={arrow.blocked ? "1.4" : "1.2"}
                  fill="none"
                  strokeDasharray={arrow.style === 'dashed' ? "3,2" : "none"}
                  strokeLinecap="round"
                />
                {/* Main arrow */}
                <path
                  d={pathD}
                  stroke={arrow.blocked ? "#D4AF37" : isPersia ? "#3d5a6a" : "#2d1810"}
                  strokeWidth={arrow.blocked ? "0.8" : "0.6"}
                  fill="none"
                  strokeDasharray={arrow.style === 'dashed' ? "3,2" : "none"}
                  markerEnd={arrow.blocked ? "url(#arrowhead-gold)" : isPersia ? "url(#arrowhead-persia)" : "url(#arrowhead)"}
                  strokeLinecap="round"
                />
                {arrow.blocked && (
                  <g>
                    <circle cx={arrow.to.x} cy={arrow.to.y} r="4" fill="none" stroke="#D4AF37" strokeWidth="2" opacity="0.9">
                      <animate attributeName="r" values="3;5;3" dur="1s" repeatCount="indefinite"/>
                    </circle>
                    <line x1={arrow.to.x - 2.5} y1={arrow.to.y - 2.5} x2={arrow.to.x + 2.5} y2={arrow.to.y + 2.5} stroke="#D4AF37" strokeWidth="2"/>
                    <line x1={arrow.to.x + 2.5} y1={arrow.to.y - 2.5} x2={arrow.to.x - 2.5} y2={arrow.to.y + 2.5} stroke="#D4AF37" strokeWidth="2"/>
                  </g>
                )}
              </g>
            );
          })}
          
          {/* Jerusalem marker - always prominent */}
          <g filter="url(#strongGlow)">
            <circle 
              cx={jerusalem.x} 
              cy={jerusalem.y} 
              r={victory || restoration ? 3.5 : 2.5} 
              fill="#D4AF37" 
              stroke="#fff" 
              strokeWidth="0.8"
            >
              {(victory || restoration) && (
                <animate attributeName="r" values="2.5;4;2.5" dur="2s" repeatCount="indefinite"/>
              )}
            </circle>
            <text x={jerusalem.x} y={jerusalem.y + 0.8} textAnchor="middle" fontSize="2.5" fill="#3d2e1e" fontFamily="serif">✡</text>
          </g>
          
          {/* City markers */}
          {Object.entries(nations).filter(([k, n]) => n.cityName && !n.contextOnly).map(([key, nation]) => (
            <g key={`city-${key}`}>
              <circle cx={nation.cityX} cy={nation.cityY} r="0.8" fill="#2a2a2a"/>
            </g>
          ))}
          
          {/* Nation labels with outline for readability */}
          {Object.entries(nations).map(([key, nation]) => (
            <g key={`label-${key}`}>
              {/* Text outline/shadow */}
              <text
                x={nation.labelX}
                y={nation.labelY}
                textAnchor="middle"
                fontSize={nation.isJudah ? "2.8" : nation.contextOnly ? "2" : "2.2"}
                fill="none"
                stroke={nation.contextOnly ? "#d4c4a8" : "#1a0f0a"}
                strokeWidth="0.6"
                fontFamily="serif"
                fontWeight={highlights.includes(key) || nation.isJudah ? "bold" : "normal"}
                fontStyle={nation.contextOnly ? "italic" : "normal"}
              >
                {nation.name}
              </text>
              {/* Main text */}
              <text
                x={nation.labelX}
                y={nation.labelY}
                textAnchor="middle"
                fontSize={nation.isJudah ? "2.8" : nation.contextOnly ? "2" : "2.2"}
                fill={nation.contextOnly ? "#6a6a6a" : highlights.includes(key) ? "#ffffff" : "#f4e4bc"}
                fontFamily="serif"
                fontWeight={highlights.includes(key) || nation.isJudah ? "bold" : "normal"}
                fontStyle={nation.contextOnly ? "italic" : "normal"}
              >
                {nation.name}
              </text>
            </g>
          ))}
          
          {/* Jerusalem label */}
          <text x={jerusalem.x} y={jerusalem.y - 5} textAnchor="middle" fontSize="2.2" fill="none" stroke="#1a0f0a" strokeWidth="0.6" fontFamily="serif" fontWeight="bold">
            Jerusalem
          </text>
          <text x={jerusalem.x} y={jerusalem.y - 5} textAnchor="middle" fontSize="2.2" fill="#ffffff" fontFamily="serif" fontWeight="bold">
            Jerusalem
          </text>
          
          {/* Compass */}
          <g transform="translate(92, 12)">
            <circle cx="0" cy="0" r="4" fill="rgba(244,228,188,0.9)" stroke="#8B7355" strokeWidth="0.3"/>
            <line x1="0" y1="-4" x2="0" y2="4" stroke="#8B7355" strokeWidth="0.3"/>
            <line x1="-4" y1="0" x2="4" y2="0" stroke="#8B7355" strokeWidth="0.3"/>
            <polygon points="0,-3.5 -0.8,-0.8 0,-1.5 0.8,-0.8" fill="#8B0000"/>
            <text x="0" y="-5" textAnchor="middle" fontSize="1.8" fill="#5c4a32" fontFamily="serif">N</text>
          </g>
          
          {/* Title */}
          <text x="50" y="4" textAnchor="middle" fontSize="2.8" fill="#3d2e1e" fontFamily="serif" fontWeight="bold">
            ISAIAH'S WORLD
          </text>
          
          {/* Legend for conquered territories */}
          {assyrianTerritories > 0 && !restoration && (
            <g transform="translate(3, 92)">
              <rect x="0" y="0" width="25" height="6" fill="rgba(244,228,188,0.9)" rx="1"/>
              <rect x="1" y="1.5" width="3" height="3" fill="#7a8c72"/>
              <text x="5.5" y="4" fontSize="1.8" fill="#3d2e1e" fontFamily="serif">= Assyrian Empire</text>
            </g>
          )}
          
          {/* Future event indicator */}
          {futureEvent && (
            <text x="50" y="98" textAnchor="middle" fontSize="1.8" fill="#4A0E4E" fontFamily="serif" fontStyle="italic">
              ✦ Prophetic Vision ✦
            </text>
          )}
        </svg>
      );
    };

    // Main App
    function App() {
      const [currentEventIndex, setCurrentEventIndex] = useState(0);
      const [isAnimating, setIsAnimating] = useState(false);
      const [selectedChapter, setSelectedChapter] = useState(null);
      const [chapterPanelOpen, setChapterPanelOpen] = useState(false);
      const currentEvent = events[currentEventIndex];

      // Count conquered nations
      const conqueredCount = Object.keys(currentEvent.conqueredBy).length;
      const mainNations = Object.keys(nations).filter(k => !nations[k].contextOnly && k !== 'judah').length;

      const goToNext = () => {
        if (currentEventIndex < events.length - 1 && !isAnimating) {
          setIsAnimating(true);
          setSelectedChapter(null); // Clear chapter selection when navigating
          setTimeout(() => { setCurrentEventIndex(prev => prev + 1); setIsAnimating(false); }, 300);
        }
      };

      const goToPrevious = () => {
        if (currentEventIndex > 0 && !isAnimating) {
          setIsAnimating(true);
          setSelectedChapter(null); // Clear chapter selection when navigating
          setTimeout(() => { setCurrentEventIndex(prev => prev - 1); setIsAnimating(false); }, 300);
        }
      };

      const goToEvent = (index) => {
        if (!isAnimating) {
          setIsAnimating(true);
          setSelectedChapter(null); // Clear chapter selection when navigating
          setTimeout(() => { setCurrentEventIndex(index); setIsAnimating(false); }, 300);
        }
      };

      const selectChapter = (chapterNum) => {
        const chapter = chapterMapping[chapterNum - 1];
        setSelectedChapter(chapter);
        const targetEvent = chapter.eventIndex !== null ? chapter.eventIndex : 0;
        if (targetEvent !== currentEventIndex && !isAnimating) {
          setIsAnimating(true);
          setTimeout(() => { setCurrentEventIndex(targetEvent); setIsAnimating(false); }, 300);
        }
      };

      useEffect(() => {
        const handleKeyDown = (e) => {
          if (e.key === 'ArrowRight' || e.key === ' ') { e.preventDefault(); goToNext(); }
          else if (e.key === 'ArrowLeft') { e.preventDefault(); goToPrevious(); }
        };
        window.addEventListener('keydown', handleKeyDown);
        return () => window.removeEventListener('keydown', handleKeyDown);
      }, [currentEventIndex, isAnimating]);
      
      return (
        <div className="min-h-screen font-serif">
          <div className="container mx-auto px-4 py-6 max-w-7xl">
            {/* Header */}
            <header className="text-center mb-6">
              <h1 className="cinzel text-3xl md:text-4xl font-bold mb-2" style={{color: '#D4AF37', textShadow: '2px 2px 4px rgba(0,0,0,0.5)'}}>
                The Prophecies of Isaiah
              </h1>
              <p className="text-lg italic" style={{color: '#c9b896'}}>
                Conquests, Judgments & The Unconquered City
              </p>
            </header>
            
            {/* Main Grid */}
            <div className="grid grid-cols-1 lg:grid-cols-2 gap-6">
              {/* Map */}
              <div className="parchment-bg rounded-lg p-4 scroll-border map-container">
                <div className={`transition-opacity duration-300 ${isAnimating ? 'opacity-50' : 'opacity-100'}`}>
                  <AncientMap 
                    conqueredBy={currentEvent.conqueredBy}
                    highlights={currentEvent.highlights}
                    arrows={currentEvent.arrows}
                    divineJudgment={currentEvent.divineJudgment}
                    futureEvent={currentEvent.futureEvent}
                    restoration={currentEvent.restoration}
                    allNationsToZion={currentEvent.allNationsToZion}
                    siege={currentEvent.siege}
                    victory={currentEvent.victory}
                    divineVictory={currentEvent.divineVictory}
                    threatened={currentEvent.threatened}
                    futureRise={currentEvent.futureRise}
                  />
                </div>
                
                {/* Legend */}
                <div className="mt-4 grid grid-cols-2 gap-2 text-xs" style={{color: '#5c4a32'}}>
                  <div className="flex items-center gap-2">
                    <div className="w-4 h-3 rounded-sm" style={{background: '#D4AF37', border: '1px solid #8B7355'}}></div>
                    <span>Judah (Unconquered)</span>
                  </div>
                  <div className="flex items-center gap-2">
                    <div className="w-4 h-3 rounded-sm" style={{background: '#7a8c72', border: '1px solid #5a6a52'}}></div>
                    <span>Assyrian Territory</span>
                  </div>
                  <div className="flex items-center gap-2">
                    <div className="w-4 h-3 rounded-sm" style={{background: '#6b8e9f', border: '1px solid #4a6a7a'}}></div>
                    <span>Persian Territory</span>
                  </div>
                  <div className="flex items-center gap-2">
                    <div className="w-4 h-3 rounded-sm border-2 border-yellow-500" style={{background: 'transparent'}}></div>
                    <span>Highlighted Nation</span>
                  </div>
                </div>
                
                {/* Conquest counter */}
                {conqueredCount > 0 && !currentEvent.restoration && (
                  <div className="mt-3 text-center">
                    <div className="inline-flex items-center gap-2 px-4 py-2 rounded-full" style={{background: 'rgba(122, 140, 114, 0.2)'}}>
                      <span className="text-sm font-semibold" style={{color: '#5a6a52'}}>
                        ⚔️ Territories Under Foreign Rule: {conqueredCount}/{mainNations}
                      </span>
                      {conqueredCount >= mainNations - 1 && !currentEvent.victory && (
                        <span className="text-xs px-2 py-0.5 rounded-full" style={{background: '#D4AF37', color: '#3d2e1e'}}>
                          Only Judah Remains!
                        </span>
                      )}
                    </div>
                  </div>
                )}

                {/* Mobile Navigation with Title - visible only on smaller screens */}
                <div className="mt-4 lg:hidden">
                  {/* Event title and year for mobile context */}
                  <div className="text-center mb-3 px-2">
                    <h2 className="cinzel text-lg font-bold" style={{color: '#3d2e1e'}}>
                      {currentEvent.title}
                    </h2>
                    <span className="text-sm" style={{
                      color: currentEvent.futureEvent ? '#4A0E4E' : currentEvent.victory ? '#8B7355' : '#5c4a32'
                    }}>
                      {currentEvent.futureEvent ? '✦ Prophetic' : currentEvent.victory ? '✦ Divine Victory' : currentEvent.year}
                    </span>
                  </div>
                  {/* Navigation buttons */}
                  <div className="flex items-center justify-between">
                    <button onClick={goToPrevious} disabled={currentEventIndex === 0}
                      className="nav-btn px-4 py-2 rounded-lg flex items-center gap-2" style={{color: '#f4e4bc'}}>
                      <span className="text-lg">←</span><span>Back</span>
                    </button>
                    <span className="cinzel text-sm font-bold" style={{color: '#5c4a32'}}>
                      {currentEventIndex + 1} / {events.length}
                    </span>
                    <button onClick={goToNext} disabled={currentEventIndex === events.length - 1}
                      className="nav-btn px-4 py-2 rounded-lg flex items-center gap-2" style={{color: '#f4e4bc'}}>
                      <span>Next</span><span className="text-lg">→</span>
                    </button>
                  </div>
                </div>
              </div>
              
              {/* Details Panel */}
              <div className="parchment-bg rounded-lg p-6 scroll-border flex flex-col">
                <div className={`flex-1 fade-in ${isAnimating ? 'opacity-0' : ''}`} key={currentEventIndex}>
                  <div className="flex items-start justify-between mb-4">
                    <span className="text-sm font-semibold px-3 py-1 rounded-full" style={{
                      background: currentEvent.futureEvent ? 'linear-gradient(135deg, #4A0E4E, #2c1810)' : 
                                 currentEvent.victory ? 'linear-gradient(135deg, #D4AF37, #8B7355)' :
                                 'linear-gradient(135deg, #8B7355, #5c4a32)',
                      color: '#f4e4bc'
                    }}>
                      {currentEvent.futureEvent ? '✦ Prophetic' : currentEvent.victory ? '✦ Divine Victory' : currentEvent.year}
                    </span>
                    <span className="cinzel text-lg font-bold" style={{color: '#8B7355'}}>
                      {currentEventIndex + 1} / {events.length}
                    </span>
                  </div>
                  
                  <h2 className="cinzel text-2xl md:text-3xl font-bold mb-4" style={{color: '#3d2e1e'}}>
                    {currentEvent.title}
                  </h2>
                  
                  <p className="text-lg leading-relaxed mb-6" style={{color: '#4a3c2d'}}>
                    {currentEvent.description}
                  </p>
                  
                  <div className="scripture-box p-4 rounded-r-lg mb-6">
                    <p className="text-base font-semibold mb-2" style={{color: '#8B7355'}}>
                      📖 {currentEvent.scripture}
                    </p>
                    <p className="italic text-lg leading-relaxed" style={{color: '#3d2e1e'}}>
                      "{currentEvent.scriptureText}"
                    </p>
                  </div>
                  
                  {currentEvent.conquestText && (
                    <div className="mb-4 p-3 rounded" style={{background: 'rgba(122, 140, 114, 0.15)'}}>
                      <p className="font-semibold text-sm" style={{color: '#5a6a52'}}>
                        ⚔️ {currentEvent.conquestText}
                      </p>
                    </div>
                  )}
                  
                  {currentEvent.siege && (
                    <div className="mb-4 p-3 rounded" style={{background: 'rgba(122, 140, 114, 0.2)', border: '1px dashed #7a8c72'}}>
                      <p className="font-semibold text-sm" style={{color: '#5a6a52'}}>
                        🏰 Jerusalem besieged — Every surrounding nation has fallen to Assyria. The empire demands surrender.
                      </p>
                    </div>
                  )}
                  
                  {currentEvent.victory && (
                    <div className="mb-4 p-3 rounded" style={{background: 'rgba(212, 175, 55, 0.2)', border: '1px solid #D4AF37'}}>
                      <p className="font-semibold text-sm" style={{color: '#8B7355'}}>
                        ✨ 185,000 Assyrians slain in one night — Jerusalem stands unconquered! God defends His city.
                      </p>
                    </div>
                  )}
                </div>
                
                {/* Navigation */}
                <div className="flex items-center justify-between pt-4 border-t" style={{borderColor: '#c9b896'}}>
                  <button onClick={goToPrevious} disabled={currentEventIndex === 0}
                    className="nav-btn px-5 py-2.5 rounded-lg flex items-center gap-2" style={{color: '#f4e4bc'}}>
                    <span className="text-xl">←</span><span className="hidden sm:inline">Previous</span>
                  </button>
                  
                  <div className="flex gap-1.5 flex-wrap justify-center max-w-xs">
                    {events.map((event, index) => (
                      <button key={event.id} onClick={() => goToEvent(index)}
                        className={`timeline-dot w-2.5 h-2.5 rounded-full transition-all ${index === currentEventIndex ? 'active' : ''}`}
                        style={{ 
                          background: index === currentEventIndex ? '#D4AF37' : 
                                     event.victory ? '#D4AF37' :
                                     event.restoration ? '#D4AF37' :
                                     Object.keys(event.conqueredBy).length > 0 ? '#7a8c72' : '#8B7355',
                          opacity: index === currentEventIndex ? 1 : 0.7
                        }}
                        title={event.title}
                      />
                    ))}
                  </div>
                  
                  <button onClick={goToNext} disabled={currentEventIndex === events.length - 1}
                    className="nav-btn px-5 py-2.5 rounded-lg flex items-center gap-2" style={{color: '#f4e4bc'}}>
                    <span className="hidden sm:inline">Next</span><span className="text-xl">→</span>
                  </button>
                </div>
              </div>
            </div>
            
            {/* Timeline Bar */}
            <div className="mt-6 parchment-bg rounded-lg p-4 scroll-border overflow-x-auto">
              <div className="flex items-center justify-between min-w-max gap-1">
                {events.map((event, index) => (
                  <button key={event.id} onClick={() => goToEvent(index)}
                    className={`flex flex-col items-center px-1.5 py-1 rounded transition-all hover:bg-black/5 ${index === currentEventIndex ? 'bg-black/10' : ''}`}
                    style={{minWidth: '45px'}}>
                    <div 
                      className={`w-3 h-3 rounded-full mb-1 transition-all ${index === currentEventIndex ? 'ring-2 ring-offset-1' : ''}`}
                      style={{
                        background: event.restoration ? '#D4AF37' : 
                                   event.victory ? '#D4AF37' :
                                   event.divineJudgment ? '#ff6b35' : 
                                   event.siege ? '#7a8c72' :
                                   Object.keys(event.conqueredBy).length > 0 ? '#7a8c72' : '#8B7355',
                        ringColor: '#D4AF37'
                      }}
                    />
                    <span className="text-xs font-semibold whitespace-nowrap" style={{
                      color: index === currentEventIndex ? '#3d2e1e' : '#8B7355',
                      fontSize: '0.65rem'
                    }}>
                      {event.year.replace(' (Prophesied)', '').replace('~', '').substring(0, 8)}
                    </span>
                  </button>
                ))}
              </div>
            </div>
            
            <p className="text-center mt-4 text-sm" style={{color: '#8B7355'}}>
              Use ← → arrow keys or spacebar to navigate • Watch as Judah becomes surrounded yet remains unconquered
            </p>

            {/* Chapter Navigator */}
            <div className="mt-6 parchment-bg rounded-lg scroll-border overflow-hidden">
              {/* Header - clickable to expand/collapse */}
              <button
                onClick={() => setChapterPanelOpen(!chapterPanelOpen)}
                className="w-full px-4 py-3 flex items-center justify-between hover:bg-black/5 transition-colors"
              >
                <span className="cinzel font-semibold flex items-center gap-2" style={{color: '#3d2e1e'}}>
                  <span>📖</span> Read by Chapter
                </span>
                <span style={{color: '#8B7355', transform: chapterPanelOpen ? 'rotate(180deg)' : 'rotate(0)', transition: 'transform 0.2s'}}>
                  ▼
                </span>
              </button>

              {/* Expandable content */}
              {chapterPanelOpen && (
                <div className="px-4 pb-4 border-t" style={{borderColor: '#c9b896'}}>
                  {/* Chapter selector */}
                  <div className="mt-3 flex flex-wrap items-center gap-2">
                    <label className="text-sm font-semibold" style={{color: '#5c4a32'}}>
                      Select chapter:
                    </label>
                    <select
                      value={selectedChapter ? selectedChapter.chapter : ''}
                      onChange={(e) => e.target.value && selectChapter(parseInt(e.target.value))}
                      className="px-3 py-2 rounded-lg text-sm font-semibold cursor-pointer"
                      style={{
                        background: 'linear-gradient(135deg, #3d2e1e 0%, #2c1810 100%)',
                        border: '2px solid #8B7355',
                        color: '#f4e4bc',
                        minWidth: '140px'
                      }}
                    >
                      <option value="">Choose...</option>
                      {chapterMapping.map((ch) => (
                        <option key={ch.chapter} value={ch.chapter}>
                          Isaiah {ch.chapter}
                        </option>
                      ))}
                    </select>
                  </div>

                  {/* Chapter context display */}
                  {selectedChapter && (
                    <div className="mt-4 p-4 rounded-lg scripture-box fade-in">
                      <h3 className="cinzel font-bold text-lg mb-2" style={{color: '#3d2e1e'}}>
                        Isaiah {selectedChapter.chapter}: {selectedChapter.title}
                      </h3>
                      <p className="text-base leading-relaxed" style={{color: '#4a3c2d'}}>
                        {selectedChapter.note}
                      </p>
                      {selectedChapter.eventIndex === null && (
                        <p className="mt-3 text-sm italic" style={{color: '#8B7355'}}>
                          ✦ This chapter focuses on theological and Messianic themes rather than specific nations on the map.
                        </p>
                      )}
                    </div>
                  )}

                  {/* Quick chapter grid for easy selection */}
                  <div className="mt-4">
                    <p className="text-xs mb-2" style={{color: '#8B7355'}}>Quick select:</p>
                    <div className="grid grid-cols-11 gap-1">
                      {chapterMapping.map((ch) => (
                        <button
                          key={ch.chapter}
                          onClick={() => selectChapter(ch.chapter)}
                          className={`w-7 h-7 text-xs rounded transition-all ${
                            selectedChapter && selectedChapter.chapter === ch.chapter
                              ? 'ring-2 ring-offset-1'
                              : 'hover:bg-black/10'
                          }`}
                          style={{
                            background: selectedChapter && selectedChapter.chapter === ch.chapter
                              ? '#D4AF37'
                              : ch.eventIndex !== null
                                ? 'rgba(139, 115, 85, 0.3)'
                                : 'rgba(139, 115, 85, 0.1)',
                            color: selectedChapter && selectedChapter.chapter === ch.chapter
                              ? '#2c1810'
                              : '#5c4a32',
                            ringColor: '#D4AF37'
                          }}
                          title={`Isaiah ${ch.chapter}: ${ch.title}`}
                        >
                          {ch.chapter}
                        </button>
                      ))}
                    </div>
                    <p className="text-xs mt-2" style={{color: '#8B7355'}}>
                      Darker = chapters with map events • Lighter = theological/Messianic focus
                    </p>
                  </div>
                </div>
              )}
            </div>

            {/* Footer */}
            <footer className="mt-8 pt-6 border-t text-center" style={{borderColor: 'rgba(139, 115, 85, 0.3)'}}>
              <p className="text-sm" style={{color: '#8B7355'}}>
                Interactive Bible tools designed by <span className="font-semibold">Daniel Whittaker</span> in partnership with <span className="font-semibold">David Couch</span>
              </p>
            </footer>
          </div>
        </div>
      );
    }

    ReactDOM.render(<App />, document.getElementById('root'));
  </script>
</body>
</html>
